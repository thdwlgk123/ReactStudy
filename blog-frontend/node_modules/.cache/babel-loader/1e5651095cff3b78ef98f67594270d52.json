{"ast":null,"code":"// import { useCallback } from \"react\";\nimport { createAction, handleActions } from \"redux-actions\";\nimport { takeLatest, call } from 'redux-saga/effects';\nimport * as authAPI from '../lib/api/auth';\nimport createRequestSaga, { createRequestActionTypes } from \"../lib/createRequestSaga\";\nconst TEMP_SET_USER = 'user/TEMP_SET_USER'; //새로고침 이후 임시 로그인 처리\n\nconst LOGOUT = 'user/logout'; //회원 정보 확인\n\nconst [CHECK, CHECK_SUCCESS, CHECK_FAILURE] = createRequestActionTypes('user/CHECK');\nexport const tempSetUser = createAction(TEMP_SET_USER, user => user);\nexport const check = createAction(CHECK);\nexport const logout = createAction(LOGOUT);\nconst checkSaga = createRequestSaga(CHECK, authAPI.check); //localstorage 안에 있는 user 값을 초기화\n\nfunction checkFailureSaga() {\n  try {\n    localStorage.removeItem('user');\n  } catch (e) {\n    console.log('local Storage is not working');\n  }\n}\n\nfunction* logoutSaga() {\n  try {\n    yield call(authAPI.logout);\n    localStorage.removeItem('user');\n  } catch (e) {\n    console.log(e);\n  }\n}\n\nexport function* userSaga() {\n  yield takeLatest(CHECK, checkSaga);\n  yield takeLatest(CHECK_FAILURE, checkFailureSaga);\n  yield takeLatest(LOGOUT, logoutSaga);\n}\nconst initialState = {\n  user: null,\n  checkError: null\n};\nexport default handleActions({\n  [TEMP_SET_USER]: (state, _ref) => {\n    let {\n      payload: user\n    } = _ref;\n    return { ...state,\n      user\n    };\n  },\n  [CHECK_SUCCESS]: (state, _ref2) => {\n    let {\n      payload: user\n    } = _ref2;\n    return { ...state,\n      user,\n      checkError: null\n    };\n  },\n  [CHECK_FAILURE]: (state, _ref3) => {\n    let {\n      payload: error\n    } = _ref3;\n    return { ...state,\n      user: null,\n      checkError: error\n    };\n  },\n  [LOGOUT]: state => ({ ...state,\n    user: null\n  })\n}, initialState);","map":{"version":3,"sources":["C:/Users/User/VCprac/blog/blog-frontend/src/modules/users.js"],"names":["createAction","handleActions","takeLatest","call","authAPI","createRequestSaga","createRequestActionTypes","TEMP_SET_USER","LOGOUT","CHECK","CHECK_SUCCESS","CHECK_FAILURE","tempSetUser","user","check","logout","checkSaga","checkFailureSaga","localStorage","removeItem","e","console","log","logoutSaga","userSaga","initialState","checkError","state","payload","error"],"mappings":"AAAA;AACA,SAASA,YAAT,EAAuBC,aAAvB,QAA4C,eAA5C;AACA,SAAQC,UAAR,EAAoBC,IAApB,QAA+B,oBAA/B;AACA,OAAO,KAAKC,OAAZ,MAAyB,iBAAzB;AACA,OAAOC,iBAAP,IAA4BC,wBAA5B,QAA4D,0BAA5D;AAEA,MAAMC,aAAa,GAAC,oBAApB,C,CAA0C;;AAC1C,MAAMC,MAAM,GAAC,aAAb,C,CAEA;;AACA,MAAM,CAACC,KAAD,EAAQC,aAAR,EAAuBC,aAAvB,IAAsCL,wBAAwB,CAAC,YAAD,CAApE;AAEA,OAAO,MAAMM,WAAW,GAACZ,YAAY,CAACO,aAAD,EAAgBM,IAAI,IAAEA,IAAtB,CAA9B;AACP,OAAO,MAAMC,KAAK,GAACd,YAAY,CAACS,KAAD,CAAxB;AACP,OAAO,MAAMM,MAAM,GAACf,YAAY,CAACQ,MAAD,CAAzB;AAEP,MAAMQ,SAAS,GAACX,iBAAiB,CAACI,KAAD,EAAOL,OAAO,CAACU,KAAf,CAAjC,C,CACA;;AACA,SAASG,gBAAT,GAA2B;AACzB,MAAG;AACDC,IAAAA,YAAY,CAACC,UAAb,CAAwB,MAAxB;AACD,GAFD,CAEC,OAAMC,CAAN,EAAQ;AACPC,IAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ;AACD;AACF;;AACD,UAAUC,UAAV,GAAsB;AACpB,MAAG;AACD,UAAMpB,IAAI,CAACC,OAAO,CAACW,MAAT,CAAV;AACAG,IAAAA,YAAY,CAACC,UAAb,CAAwB,MAAxB;AACD,GAHD,CAGC,OAAMC,CAAN,EAAQ;AACPC,IAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACD;AACF;;AACD,OAAO,UAAUI,QAAV,GAAoB;AACzB,QAAMtB,UAAU,CAACO,KAAD,EAAQO,SAAR,CAAhB;AACA,QAAMd,UAAU,CAACS,aAAD,EAAgBM,gBAAhB,CAAhB;AACA,QAAMf,UAAU,CAACM,MAAD,EAAQe,UAAR,CAAhB;AACD;AAGD,MAAME,YAAY,GAAC;AACjBZ,EAAAA,IAAI,EAAC,IADY;AACNa,EAAAA,UAAU,EAAC;AADL,CAAnB;AAIA,eAAezB,aAAa,CAC1B;AACE,GAACM,aAAD,GAAgB,CAACoB,KAAD;AAAA,QAAQ;AAACC,MAAAA,OAAO,EAACf;AAAT,KAAR;AAAA,WAA0B,EAAC,GAAGc,KAAJ;AAAWd,MAAAA;AAAX,KAA1B;AAAA,GADlB;AAEE,GAACH,aAAD,GAAgB,CAACiB,KAAD;AAAA,QAAQ;AAACC,MAAAA,OAAO,EAACf;AAAT,KAAR;AAAA,WAA0B,EAAC,GAAGc,KAAJ;AAAWd,MAAAA,IAAX;AAAgBa,MAAAA,UAAU,EAAC;AAA3B,KAA1B;AAAA,GAFlB;AAGE,GAACf,aAAD,GAAgB,CAACgB,KAAD;AAAA,QAAQ;AAACC,MAAAA,OAAO,EAACC;AAAT,KAAR;AAAA,WAA2B,EAAC,GAAGF,KAAJ;AAAWd,MAAAA,IAAI,EAAC,IAAhB;AAAqBa,MAAAA,UAAU,EAACG;AAAhC,KAA3B;AAAA,GAHlB;AAIE,GAACrB,MAAD,GAASmB,KAAK,KAAG,EACf,GAAGA,KADY;AACNd,IAAAA,IAAI,EAAC;AADC,GAAH;AAJhB,CAD0B,EAS1BY,YAT0B,CAA5B","sourcesContent":["// import { useCallback } from \"react\";\r\nimport { createAction, handleActions } from \"redux-actions\";\r\nimport {takeLatest, call} from 'redux-saga/effects';\r\nimport * as authAPI from '../lib/api/auth';\r\nimport createRequestSaga, { createRequestActionTypes } from \"../lib/createRequestSaga\";\r\n\r\nconst TEMP_SET_USER='user/TEMP_SET_USER'; //새로고침 이후 임시 로그인 처리\r\nconst LOGOUT='user/logout';\r\n\r\n//회원 정보 확인\r\nconst [CHECK, CHECK_SUCCESS, CHECK_FAILURE]=createRequestActionTypes('user/CHECK');\r\n\r\nexport const tempSetUser=createAction(TEMP_SET_USER, user=>user);\r\nexport const check=createAction(CHECK);\r\nexport const logout=createAction(LOGOUT);\r\n\r\nconst checkSaga=createRequestSaga(CHECK,authAPI.check);\r\n//localstorage 안에 있는 user 값을 초기화\r\nfunction checkFailureSaga(){\r\n  try{\r\n    localStorage.removeItem('user');\r\n  }catch(e){\r\n    console.log('local Storage is not working');\r\n  }\r\n}\r\nfunction* logoutSaga(){\r\n  try{\r\n    yield call(authAPI.logout);\r\n    localStorage.removeItem('user');\r\n  }catch(e){\r\n    console.log(e);\r\n  }\r\n}\r\nexport function* userSaga(){\r\n  yield takeLatest(CHECK, checkSaga);\r\n  yield takeLatest(CHECK_FAILURE, checkFailureSaga);\r\n  yield takeLatest(LOGOUT,logoutSaga);\r\n}\r\n\r\n\r\nconst initialState={\r\n  user:null, checkError:null\r\n}\r\n\r\nexport default handleActions(\r\n  {\r\n    [TEMP_SET_USER]:(state, {payload:user})=>({...state, user}),\r\n    [CHECK_SUCCESS]:(state, {payload:user})=>({...state, user,checkError:null}),\r\n    [CHECK_FAILURE]:(state, {payload:error})=>({...state, user:null,checkError:error}),\r\n    [LOGOUT]:state=>({\r\n      ...state,user:null\r\n    })\r\n  },\r\n  initialState\r\n)"]},"metadata":{},"sourceType":"module"}